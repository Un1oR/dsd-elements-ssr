name: commits
description: Use when preparing a git commit, editing history, or crafting a commit message —
  enforces Conventional Commits, approval, and tone alignment.
---

# Правила коммитов

## Когда использовать
- Любая подготовка `git commit`, amend, rebase, squash.
- Нужно придумать subject/описание коммита.
- Перед push/PR для быстрой самопроверки формата.

## Основные правила
- Формат Conventional Commits: `type(scope): subject` в императиве, без точки.
- Перед любым коммитом получи явное разрешение пользователя.
- Подбирай лексику по последним 10 коммитам: `git log -10 --oneline`.
- Не включай отладочные/временные файлы; держи рабочее дерево чистым.
- Весь commit message (subject и body) пиши на английском.
- При сомнении покажи пользователю черновик subject/тела и спроси ок ли.

## Минимальный стандарт информативности
- Всегда добавляй body, если изменений >1 файла, затронуты правила/процессы, либо
  есть удаления/переезды. Для совсем мелких одиночных правок допускается пустой
  body, но это исключение.
- Body — списком `-`, 2–5 коротких пунктов: что изменил и зачем. Называй ключевые
  области/файлы, чтобы читатель понял масштаб без диффа.
- Если были удаления/rename, отдельный буллет «Remove …» или «Rename …».
- Если выбираешь scope, он должен соответствовать главной области правки
  (например, `agent`, `frontend`, `backend`, `docs`). Нет уверенности — без scope.
- Перед коммитом быстро сверяйся с примером ниже: subject в повелительном
  наклонении, body — пара лаконичных пунктов без пересказа диффа.

## Форматирование body
- Если body содержит несколько независимых пунктов, каждый пункт должен быть на
  новой строке с буллетом `-`.
- Каждый пункт должен быть самостоятельным и понятным без контекста других пунктов.
- Не объединяй несколько изменений в один пункт; разбивай на отдельные буллеты.
- Не вставляй пустые строки между буллетами.
  Список должен идти плотным блоком без прослоек.
- Никогда не вставляй литералы `\n` внутри `-m`.
- Используй реальные переводы строк: несколько флагов `-m` или `git commit -F`
  (через heredoc/файл).
- В агентной среде нет TTY, интерактивный редактор (`git commit` без `-m`) не
  сработает; используй только `-m` или `-F`.

### Как писать body из CLI
- Надёжно: `cat <<'EOF' | git commit -F -
type: subject

- пункт 1
- пункт 2
EOF`
  Следи, чтобы строки были настоящими, а не экранированными.
- Быстро: `git commit -m $'type: subject\n\n- пункт 1\n- пункт 2'`
  Один `-m` с `\n` внутри не добавляет пустых строк между буллетами.
- Запрещено: несколько `-m` для буллетов (`git commit -m "..." -m "- пункт"`).
  Git вставляет пустую строку между каждым `-m`, тело превращается в разрозненные
  абзацы и нарушает требование «без пустых строк между буллетами».

## Быстрые подсказки
- type: feat, fix, chore, docs, refactor, test, ci.
- scope опционален; если неясен — опусти, не выдумывай.
- body: коротко «что/почему», без пересказа диффа. Форматируй списком с буллетами
  `-` если пунктов несколько.

## Пример хорошего коммита

```
refactor(agent): migrate cursor rules to openskills format

- Remove legacy .cursor/rules/*.mdc
- Update .cursorrules and AGENTS.md to load openskills
- Add .agent/skills/* with extracted instructions and helper scripts
```

## Частые ошибки
- Коммит без разрешения пользователя.
- Subject в прошедшем времени или с точкой на конце.
- Фантазийный scope не по коду.
- Коммит временного мусора или отладочных артефактов.
- Однострочный body с `\n` вместо реальных переносов: всегда используй
  многострочный ввод.
- Попытка открыть редактор (`git commit` без `-m`/`-F`) в среде без TTY:
  используй только `-m` или `-F`.
